<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Blossom</title>
    <!-- <script src="http://livejs.com/live.js" charset="utf-8"></script> -->
    <script src="js/lib/bonsai-0.4.5.min.js" charset="utf-8"></script>
    <script src="js/lib/jquery-3.1.1.min.js" charset="utf-8"></script>
    <style media="screen">
      body { margin: 0px; background-color: grey; }
      canvas { width: 100%; height: 100%; }
    </style>
  </head>
  <body>
    <button type="button" name="button" onclick="logger();">Oieee</button>
    <div id="main">
      <p id="test" style="color: grey;">oieee</p>
    </div>
    <script>
      // var instance = bonsai.run(document.getElementById('main'), {
      //   url: 'js/app/main.js',
      //   width: $(window).width()-5,
      //   height: $(window).height()-5
      // });
      // console.log(instance);
      // $(window).on('resize', function() {
      //   instance.destroy();
      //   instance = bonsai.run(document.getElementById('main'), {
      //     url: 'js/app/main.js',
      //     width: $(window).width()-20,
      //     height: $(window).height()-20
      //   });
      // });
      var movie = bonsai.run(document.getElementById('main'),
        {
          code: function() {
            // receive data from the other side
            var text = new Text().addTo(stage);
            stage.on('message', function(data) {
              console.log(data);
              text.attr('text', data.text);
              console.log(text);
            });
            stage.sendMessage('ready', {});
          }
        }
      );
      // emitted before code gets executed
      movie.on('load', function() {
        // receive event from the runner context
        movie.on('message:ready', function() {
          // send a categorized message to the runner context
          movie.sendMessage({
            text: document.getElementById('test').innerHTML
          });
        });
      });
    </script>
  </body>
</html>
